LOTRFGen - аддон к моду "Властелин колец" для Minecraft, который выводит информацию о нём в виде парсеров и таблиц, предназначенных для MediaWiki. Быстро портируется на сабмоды "Властелина колец". Также пригоден для отлова багов, вроде неприсвоенных полей и непереведённых строк.

Приведённая ниже документация будет полезна как разработчикам, так и мне самому из будущего. Сведения, гайды, подводные камни, советы и всё такое. 

<h2> Общая информация </h2>

> [!NOTE]
> У меня на компьютере в переменных средах указана JDK Eclipse Temurin 1.8.0_382. Если у вас в ходе установки что-то пошло не так, первым делом проверьте версию Java на комьютере. Вторым делом - проверьте версию Java в IDE, об этом будет раздел ниже.

Этот репозиторий - проект Gradle, который должен быть импортирован в Eclipse IDE или открыт через IntelliJ IDEA. Однако, не всё так просто - версия 1.7.10 вышла в 2014 году, и с тех пор все инструменты для разработки уже устарели. Более того, даже на момент создания они были неидеальны и требовали костыли. Костыли реализуются созданием файлов IDE.

* В папке есть два батника, `setupEclipse` и `setupIdea`. Выбираем нужный, запускаем, ждём окончания.
  * Под капотом батников лежат команды консоли Windows `gradlew setupDecompWorkspace eclipse` и `gradlew setupDecompWorkspace idea` соответственно. Если желаете взять процесс в свои руки и не полагаться на батники, можете вместо их запуска прописывать эти команды в консоли Windows и эффект будет тот же. Смысл батника, скорее, не в экономии времени, а в напоминании о том, что эта версия требует костыль.
* После окончания генерации среды мы импортируем сгенерированный проект IDE. ***Именно проект IDE!*** Это не проект Gradle.
  * В случае Eclipse IDE мы импортируем всю папку как "существующий Eclipse-проект".
  * В случае IntelliJ IDEA мы открываем файл `.ipr`. Загрузку скриптов Gradle нужно пропустить. Когда инициализация закончится, крайне рекомендуется в меню `File -> Manage IDE Settings` конвертировать проект `.ipr` в Directory-based format, иначе багов и зависаний не миновать.
    * Существуют фокусы с открытием файла проекта Eclipse (`.project`) через IntelliJ IDEA, тогда ещё нужно добавить модуль видимости. Работать будет, но зачем всё это?
* Чтобы запустить мод, используйте следующий подход.
  * В случае IntelliJ IDEA у нас уже сгенерированы сверху два варианта запуска, клиент и сервер. Сервер не работает, это норма.
  * В случае Eclipse IDE мы должны самостоятельно создать новую конфигурацию запуска. Это делается возле зелёного кружочка запуска - там есть чёрный треугольник, при нажатии на который можно увидеть Run Configurations. Нажимаем, затем выбираем слева Java Application и жмём сверху слева на белый документ. Появляется ненастроенный запуск. Настраиваем его.
    * В первой вкладке указываем проект - это папка, для которой мы создаём запуски.
    * В первой вкладке указываем файл входа - это `GradleStart`.
    * Во вкладке Arguments нужно сверху выделить память: `-Xincgc -Xmx2G -Xms2G`.
    * Во вкладке Arguments нужно снизу указать рабочую папку. Например, создайте в скачанном репозитории папку run и укажите её, как рабочую.
    * Сохраняем.
* Чтобы скомпилировать мод, используйте следующий подход.
  * В случае Eclipse IDE откройте консоль Windows в папке среды и введите `gradlew build`.
  * В случае IntelliJ IDEA создайте собственный Gradle Task с командой `build` на вашем проекте и выполните его, либо откройте консоль Windows в папке среды и введите `gradlew build`.
* Готовый мод лежит в папке `среда_разработки/build/libs`.

<h2> Сведения об используемых JDK/SDK и Compiler Compliance Level/Language Level </h2>

У Minecraft, Forge, ForgeGradle и Gradle есть свои требования к установленной версии Java и допуску её синтаксиса (с годами в язык добавляют новые конструкции, для которых ещё нет поддержки у вышеуказанных технологий).

> [!IMPORTANT]
> Версия 1.7.10 использует Java 8 + допуск синтаксиса 8.

Обязательно проконтролируйте, чтобы в вашей IDE после установки были именно такие значения, а если они другие - измените их. Ваш мод может попросту не запуститься и не скомпилироваться, если вы этого не сделаете.

Java в Eclipse называется JRE/JDK, в IntelliJ IDEA - SDK. Допуск синтаксиса в Eclipse называется Compiler Compliance Level, в IntelliJ IDEA - Language Level.

<h2> Использование </h2>

Чтобы сгенерировать первую и основную часть информации, войдите в игру и введите команду "/db xml". Так вы получите файл \*.xml в директории игры (.minecraft/hummel/\*.xml). Этот файл можно импортировать на MediaWiki. Пример хорошего бесплатного хостинга MediaWiki - Fandom. В итоге будет сгенерировано несколько сотен статей на том языке, который был у вас в игре.

Чтобы статьи заработали и начали отображать информацию, вам нужно скопировать и отредактировать под себя 6 шаблонов MediaWiki:

* [Статья Биом](https://gotminecraftmod.fandom.com/wiki/Template:Статья_Биом)
* [Статья Фракция](https://gotminecraftmod.fandom.com/wiki/Template:Статья_Фракция)
* [Статья Моб](https://gotminecraftmod.fandom.com/wiki/Template:Статья_Моб)
* [Статья Дерево](https://gotminecraftmod.fandom.com/wiki/Template:Статья_Дерево)
* [Статья Ископаемое](https://gotminecraftmod.fandom.com/wiki/Template:Статья_Ископаемое)
* [Статья Структура](https://gotminecraftmod.fandom.com/wiki/Template:Статья_Структура)

Не забывайте также и о подшаблонах, которые будут гореть красным цветом. Если у вас возникли вопросы, можете задавать их опытным участникам Википедии - они умеют обращаться с шаблонами.

<h2> Дополнительно </h2>

Вторая часть информации - это "/db tables". Так вы получите около 10 файлов в директории игры (.minecraft/hummel/\*.txt), их можно использовать как код обычных таблиц в MediaWiki и размещать там, где посчитаете нужным. Главное - не забыть сделать заголовок и завершение таблицы.

Для загрузки изображений примените массовую загрузку ассетов мода.

В конечном итоге вы получите достаточно большой и хорошо заполненный сайт MediaWiki. Аддон можно приспособить, по сути, для любого сабмода LOTR.

<h2> Полезные побочные эффекты </h2>

Отлов ошибок производится следующим образом: можно открыть в блокноте каждый из сгенерированных файлов и искать там строки с фрагментами "name", "title", "desc", "info", "null" и т.д. Строки с упомянутыми фрагментами в 90% указывают на баг.

Если же ваши файлы баз данных вовсе не создались, то, возможно, у вас в коде мода кроется NullPointerException. Самое время пройтись по папке .minecraft/logs и посмотреть, какие ошибки выдала команда базы данных.

Для адаптации к сабмодам LOTR необходимо через JD GUI скопировать методы регистрации в файлах LOTREntities и LOTRStructures и вставить их в файл LFGConfig в практически неизменном виде, переименовав методы регистрации на методы получения информации. Затем может потребоваться обновление импортов во всех файлах и запуск.
